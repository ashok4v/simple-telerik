(function(b){var a=b.telerik;var c=null;var d=/\d/;b.extend(a.datetime,{parse:function(f,g,i,e,h){g=a.calendar.standardFormat(g)?a.calendar.standardFormat(g):g;if(d.test(f)){return a.datetime.parseMachineDate(f,g,e,h)}return a.datetime.parseByToken(f,i,e,h)},parseMachineDate:function(e,q,w,h){var j=-1;var t=-1;var x=-1;var n="+10";var s=false;var i=function(z){var A=0;while(f(z)){A++;o++}return A};var k=function(){var z=f("'");if(z){o++}return z};var f=function(z){return(o+1<q.length&&q.charAt(o+1)==z)};var m=function(B){var z=B=="y"?4:2;var A=new RegExp("^\\d{1,"+z+"}");var C=e.substring(g).match(A);if(C){g+=C[0].length;return parseInt(C[0],10)}else{return -1}};var u=function(A){for(var z=0;z<A.length;z++){if(e.substr(g,A[z].length)==A[z]){g+=A[z].length;return z+1}}return -1};var p=function(){if(e.charAt(g)==q.charAt(o)){g++}};var g=0;for(var o=0,l=q.length;o<l;o++){if(s){p();if(q.charAt(o)=="'"){s=false}}else{switch(q.charAt(o)){case"d":var v=i("d");x=v<=1?m("d"):u(a.cultureInfo[v==3?"days":"abbrDays"]);break;case"M":var v=i("M");t=v<=1?m("M"):u(a.cultureInfo[v==3?"months":"abbrMonths"]);break;case"y":i("y");j=m("y");break;case"'":p();s=true;break;default:p()}}}if(g<e.length-1){return null}var r=new a.datetime();if(j==-1){j=r.year()}else{if(j<100){j+=r.year()-r.year()%100+(j<=n?0:-100)}}var y=new a.datetime(j,t-1,x);y.hours(y.hours()>12?y.hours()+2:0);if(y.year()!=j&&y.month()+1!=t&&y.date()!=x){return null}if(w&&h){y=a.calendar.isInRange(y,w,h)?y:null}return y},parseByToken:function(h,o,g,j){o=o||new a.datetime();var p=null;var f=null;var k=null;var e=0;var n=function(q){var r=null;if(q&&h.substring(e,e+q.length).toLowerCase()==q.toLowerCase()){r=q}return r};var l=function(){var q=null;b.each(["days","abbrDays","months","abbrMonths"],function(s,r){if(q!==null){return}b.each(a.cultureInfo[r],function(u,t){if(q!==null){return}q=n(t)});k=r});return q};var m=function(){var r;var s=function(u,t){o[t?"date":"month"](o[t?"date":"month"]()+(r!=0?((r+((r>0?1:-1)*u))%u):0)+(f?(p==a.cultureInfo.next?1:-1)*u:0))};var q=b.inArray(f||p,a.cultureInfo[k]);if(k.toLowerCase().indexOf("day")>-1){r=(q==0?7:q)-o.day();s(7,true)}else{r=q-o.month();s(12,false)}};var i=function(){var q=function(t){var s;switch(f){case"year":s=t==1?1:0;break;case"month":s=t==2?1:0;break;case"week":s=t==3?7:0;break;case"day":s=t==3?1:0;break}return s};var r=(p==a.cultureInfo.next?1:-1);o.year(o.year()+q(1)*r,o.month()+q(2)*r,o.date()+q(3)*r)};b.each(["today","tomorrow","yesterday","next","last"],function(r,q){if(p!==null){return}p=n(a.cultureInfo[q])});if(p!==null){e+=p.length;if(/[^\s\d]\s+[^\s\d]/i.test(h)){e++;b.each(["year","month","week","day"],function(r,q){if(f!==null){return}f=n(a.cultureInfo[q])});k=null;if(f===null){f=l()}if(f===null){return null}}else{switch(p){case a.cultureInfo.today:break;case a.cultureInfo.tomorrow:o.date(o.date()+1);break;case a.cultureInfo.yesterday:o.date(o.date()-1);break;default:o=null;break}if(g&&j){o=a.calendar.isInRange(o,g,j)?o:null}return o}}else{p=l();if(p!=null){m();if(g&&j){o=a.calendar.isInRange(o,g,j)?o:null}return o}else{return null}}if(k!==null){m()}else{i()}if(g&&j){o=a.calendar.isInRange(o,g,j)?o:null}return o}});a.datepicker=function(f,g){this.element=f;this.isValueChanged=false;b.extend(this,g);b("> .t-icon",f).bind("click",a.delegate(this,this.togglePopup));var e=b(".t-input",f).keydown(a.delegate(this,this.keyDown)).focus(a.delegate(this,this.show)).attr("autocomplete","off");this.focusedDate=this.selectedDate||(a.calendar.isInRange(this.focusedDate,this.minDate,this.maxDate)?this.focusedDate:new a.datetime(this.minDate.value));a.bind(this,{open:this.onOpen,close:this.onClose,change:this.onChange,load:this.onLoad});a.trigger(f,"load")};b.extend(a.datepicker,{hideSharedCalendar:function(g){var f=c.data("associatedDatePicker");if(f){if(b.contains(f,g.target)){return}var h=b(f).data("tDatePicker");if(!h){h=b(f).tDatePicker().data("tDatePicker")}h.parseDate(b(".t-input",f).val());h.hide()}},adjustDate:function(e,f,h,g){if(e==0){a.datetime.modify(f,a.datetime.msPerDay*h)}else{if(e==1){f.addMonth(g)}else{f.addYear((e==2?g:10*g))}}}});a.datepicker.prototype={$calendar:function(){if(!c){c=b(a.calendar.html(this.focusedDate,this.selectedDate,this.minDate,this.maxDate)).hide().addClass("t-datepicker-calendar").bind("click",function(h){h.stopPropagation()}).appendTo(document.body).tCalendar({selectedDate:this.selectedDate,minDate:this.minDate,maxDate:this.maxDate});b(document).click(a.datepicker.hideSharedCalendar)}if(c.data("associatedDatePicker")!=this.element){calendar=c.data("tCalendar");calendar.minDate=this.minDate;calendar.maxDate=this.maxDate;calendar.selectedDate=this.selectedDate;calendar.goToView(0,this.focusedDate);var g=b(this.element).offset();g.top+=b(this.element).height();var f=a.fx._wrap(c);f.css(b.extend({position:"absolute"},g));c.unbind("change").bind("change",b.proxy(this.calendarChange,this)).unbind("navigate").bind("navigate",b.proxy(this.viewedMonthChanged,this)).data("associatedDatePicker",this.element);if(this.selectedDate){this.value(this.focusedDate)}}var e=calendar.currentView.index;if(!c.is(":visible")&&calendar.viewedMonth.value-this.focusedDate.value!=0){calendar.goToView(e,this.focusedDate).value(this.selectedDate)}a.calendar.focusDate(this.focusedDate,e,c);return c},isOpened:function(){return c&&c.data("associatedDatePicker")==this.element&&c.is(":visible")},viewedMonthChanged:function(h){var i=c.data("tCalendar");var f=i.viewedMonth;var g=i.currentView.index;if(g==0){this.focusedDate=this.selectedDate||this.focusedDate}else{this.focusedDate.year(f.year(),f.month(),this.focusedDate.date())}a.calendar.focusDate(this.focusedDate,g,c,h.direction)},value:function(e){if(arguments.length==0){return this.selectedDate===null?null:this.selectedDate.toDate()}var g=e===null?null:e.getDate||e.value?e:this.parse(e);var f=g===null;this.selectedDate=f?null:g.value?g:new a.datetime(g);if(!f){this.focusedDate=this.selectedDate}b(".t-input",this.element).val(f?"":a.calendar.formatDate(this.selectedDate.toDate(),this.format));if(this.isOpened()){this.$calendar().data("tCalendar").value(this.selectedDate)}return this},calendarChange:function(g){var f=new a.datetime(g.date);if(this.checkSelectedDate(this.selectedDate,f)){return this}b(".t-input",this.element).removeClass("t-state-error");this.hide()},checkSelectedDate:function(f,e){if(!f||(f.value>e.value||e.value>f.value)){this.value(e);return a.trigger(this.element,"change",{previousDate:f===null?null:f.toDate(),date:e.toDate()})}},togglePopup:function(g){g.preventDefault();if(this.isOpened()){var f=b(".t-input",this.element);this.parseDate(f.val());f.blur();this.hide()}else{b(".t-input",this.element).focus()}},showPopup:function(){var e=this.parse(b(":input",this.element).val());this.selectedDate=e;if(e!==null){this.focusedDate=new a.datetime(e.value)}a.fx.play(this.effects,this.$calendar(),{direction:"bottom"})},hidePopup:function(){if(this.isOpened()){a.fx.rewind(this.effects,this.$calendar(),{direction:"bottom"})}},show:function(){a.trigger(this.element,"open");this.showPopup()},hide:function(){if(this.isOpened()){a.trigger(this.element,"close")}this.hidePopup()},keyDown:function(o){var h=b(o.target).val();if(o.keyCode==9){this.parseDate(h);this.hide()}if(o.keyCode==27){this.hide()}if(this.isOpened()&&b(".t-overlay",c).length>0){return}var p;var r=false;var m=this.$calendar();var i=m.data("tCalendar");var q=i.viewedMonth;var j=i.currentView;var f=i.currentView.index;var g=new a.datetime(this.focusedDate.value);var l=function(w,e,v){if(!b(w,m).hasClass("t-state-disabled")){if("navigateUp"==e){f+=1}p=v||false;i[e]();return true}else{return false}};var s=function(){var e=a.calendar.findTarget(g,f,m,false)[0];i.navigateDown(o,e,f);f=f==0?0:f-1;p=true};var k=function(w,e,v){var x=!v?-1:1;if(!l(w,e,v)){return false}if(f==0){g.addMonth(x)}else{g.addYear(x*(f==1?1:f==2?10:100))}return true};if(m.is(":visible")&&!o.shiftKey){switch(o.keyCode){case 37:r=true;if(o.ctrlKey){if(!k(".t-nav-prev","navigateToPast")){return}}else{a.datepicker.adjustDate(f,g,-1,-1);if(j.navCheck(g,q,false)){if(!l(".t-nav-prev","navigateToPast")){return}}}break;case 38:r=true;if(o.ctrlKey){l(".t-nav-fast","navigateUp")}else{a.datepicker.adjustDate(f,g,-7,-4);if(j.navCheck(g,q,false)){if(!l(".t-nav-prev","navigateToPast")){return}}}break;case 39:r=true;if(o.ctrlKey){if(!k(".t-nav-next","navigateToFuture",true)){return}}else{a.datepicker.adjustDate(f,g,1,1);if(j.navCheck(g,q,true)){if(!l(".t-nav-next","navigateToFuture",true)){return}}}break;case 40:r=true;if(o.ctrlKey){s()}else{a.datepicker.adjustDate(f,g,7,4);if(j.navCheck(g,q,true)){if(!l(".t-nav-next","navigateToFuture",true)){return}}}break;case 33:if(!k(".t-nav-prev","navigateToPast")){return}r=true;break;case 34:if(!k(".t-nav-next","navigateToFuture",true)){return}r=true;break;case 35:g=a.calendar.views[f].firstLastDay(g,false,i);r=true;break;case 36:g=a.calendar.views[f].firstLastDay(g,true,i);r=true;break;case 13:if(this.isValueChanged){this.parseDate(h);this.isValueChanged=false;break}r=true;if(f==0){b(o.target).removeClass("t-state-error");if(this.checkSelectedDate(this.selectedDate,this.focusedDate)){return}this.hide()}else{s()}break}}else{if(o.altKey&&o.keyCode==40){this.show();var t=this.parseDate(h);if(h!=""&&t===null){r=true}}else{if(o.keyCode==13){this.parseDate(h)}}}if(r){o.preventDefault();g=a.calendar.fitDateToRange(g,this.minDate,this.maxDate);a.calendar.focusDate(g,f,m,p);this.focusedDate=g}else{var u=o.keyCode;var n=function(v,e,w){return v>e&&v<w};if(n(u,47,57)||n(u,65,90)||n(u,95,105)||u==8||u==32||u==47){this.isValueChanged=true}}},parseDate:function(f){var g=null;var h=function(){this.selectedDate=null;if(this.isOpened()){this.$calendar().data("tCalendar").selectedDate=null;b(".t-state-selected",this.$calendar()).removeClass("t-state-selected")}};if(f!=""){g=this.parse(f,this.format);var e=g===null;if(!e){this.focusedDate=g;if(this.checkSelectedDate(this.selectedDate,g)){return}}else{b.proxy(h,this)()}b(".t-input",this.element).toggleClass("t-state-error",e).val(e?f:a.calendar.formatDate(g.toDate(),this.format))}else{b(".t-input",this.element).removeClass("t-state-error");b.proxy(h,this)()}return g},parse:function(e,f,g){return a.datetime.parse(e,f||this.format,g,this.minDate,this.maxDate)}};b.fn.tDatePicker=function(e){e=b.extend({},b.fn.tDatePicker.defaults,e);return this.each(function(){e=b.meta?b.extend({},e,b(this).data()):e;if(!b(this).data("tDatePicker")){b(this).data("tDatePicker",new a.datepicker(this,e))}})};b.fn.tDatePicker.defaults={effects:a.fx.slide.defaults(),selectedDate:null,format:a.cultureInfo.shortDate,focusedDate:new a.datetime(),minDate:new a.datetime(1899,11,31),maxDate:new a.datetime(2100,0,1)}})(jQuery);